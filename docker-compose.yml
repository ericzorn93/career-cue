version: '3.9'
services:
  inbound-webhooks-api:
    image: career-cue/inbound-webhooks-api
    container_name: career-cue-inbound-webhooks-api
    build:
      context: .
      dockerfile: ./apps/services/inbound-webhooks-api/Dockerfile
    ports:
      - 3000:3000
      - 5001:5000
    env_file:
      - ./apps/services/inbound-webhooks-api/.env.local
    volumes:
      - inbound-webhooks-api:/app
  accounts-api:
    image: career-cue/accounts-api
    container_name: career-cue-accounts-api
    build:
      context: .
      dockerfile: ./apps/services/accounts-api/Dockerfile
    ports:
      - 3001:3000
    env_file:
      - ./apps/services/accounts-api/.env.local
    volumes:
      - accounts-api:/app
  accounts-worker:
    image: career-cue/accounts-worker
    container_name: career-cue-accounts-worker
    build:
      context: .
      dockerfile: ./apps/services/accounts-worker/Dockerfile
    ports:
      - 3002:3000
    env_file:
      - ./apps/services/accounts-worker/.env.local
    volumes:
      - accounts-worker:/app
  lavinmq:
    image: cloudamqp/lavinmq:latest
    container_name: lavinmq
    hostname: lavinmq
    ports:
      - 15672:15672 # Management UI
      - 5672:5672 # AMQP
    restart: always
volumes:
  inbound-webhooks-api:
  accounts-api:
  accounts-worker:
  lavinmq:
